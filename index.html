<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Bird Easy</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #2c3e50;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }
        
        canvas {
            border: 2px solid #34495e;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        
        .overlay {
            position: absolute;
            text-align: center;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        
        h1 {
            font-size: 48px;
            margin-bottom: 20px;
            color: #f1c40f;
        }
        
        p {
            font-size: 24px;
            margin: 10px 0;
        }
        
        .instructions {
            font-size: 20px;
            margin-top: 30px;
        }
        
        .game-over {
            color: #e74c3c;
        }
        
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="400" height="600"></canvas>
    
    <div id="startScreen" class="overlay">
        <h1>Flappy Bird</h1>
        <p class="instructions">اضغط على المسافة أو انقر للبدء</p>
    </div>
    
    <div id="gameOverScreen" class="overlay hidden">
        <h1 class="game-over">انتهت اللعبة</h1>
        <p id="finalScore">النقاط: 0</p>
        <p class="instructions">اضغط على المسافة أو انقر لإعادة اللعب</p>
    </div>

    <script>
        // عناصر DOM
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const startScreen = document.getElementById('startScreen');
        const gameOverScreen = document.getElementById('gameOverScreen');
        const finalScoreElement = document.getElementById('finalScore');
        
        // الألوان
        const SKY_BLUE = '#71C5CF';
        const WHITE = '#FFFFFF';
        const BLACK = '#000000';
        const GREEN = '#4C9141';
        const BROWN = '#A5714E';
        const YELLOW = '#FFD93D';
        const ORANGE = '#FF9900';
        const RED = '#EB4034';
        
        // متغيرات اللعبة
        let gameState = "start"; // start, playing, game_over
        let score = 0;
        let highScore = 0;
        let scrollOffset = 0;
        let pipeTimer = 0;
        let backgroundElements = [];
        
        // إنشاء عناصر الخلفية
        for (let i = 0; i < 10; i++) {
            let x = Math.random() * canvas.width;
            let y = 100 + Math.random() * (canvas.height - 200);
            let size = 2 + Math.random() * 3;
            backgroundElements.push({x, y, size});
        }
        
        // الطائر
        class Bird {
            constructor() {
                this.x = 80;
                this.y = canvas.height / 2;
                this.radius = 15;
                this.velocity = 0;
                this.gravity = 0.5;
                this.jumpStrength = -8;
                this.angle = 0;
                this.flapCounter = 0;
                this.wingUp = false;
            }
            
            draw() {
                // جسم الطائر
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                ctx.fillStyle = YELLOW;
                ctx.fill();
                ctx.closePath();
                
                // العين
                ctx.beginPath();
                ctx.arc(this.x + 8, this.y - 5, 8, 0, Math.PI * 2);
                ctx.fillStyle = WHITE;
                ctx.fill();
                ctx.closePath();
                
                ctx.beginPath();
                ctx.arc(this.x + 10, this.y - 5, 4, 0, Math.PI * 2);
                ctx.fillStyle = BLACK;
                ctx.fill();
                ctx.closePath();
                
                // المنقار
                ctx.beginPath();
                ctx.moveTo(this.x + 15, this.y - 2);
                ctx.lineTo(this.x + 25, this.y);
                ctx.lineTo(this.x + 15, this.y + 2);
                ctx.fillStyle = ORANGE;
                ctx.fill();
                ctx.closePath();
                
                // الأجنحة - تتحرك
                this.flapCounter += 1;
                if (this.flapCounter > 5) {
                    this.wingUp = !this.wingUp;
                    this.flapCounter = 0;
                }
                
                let wingYOffset = this.wingUp ? -5 : 5;
                ctx.beginPath();
                ctx.ellipse(this.x - 15, this.y + wingYOffset, 10, 5, 0, 0, Math.PI * 2);
                ctx.fillStyle = YELLOW;
                ctx.fill();
                ctx.closePath();
            }
            
            update() {
                this.velocity += this.gravity;
                this.y += this.velocity;
                
                // تحديد زاوية الطائر بناء على السرعة
                this.angle = -this.velocity * 2;
                this.angle = Math.max(-30, Math.min(this.angle, 45));
            }
            
            jump() {
                this.velocity = this.jumpStrength;
                playJumpSound();
            }
            
            checkCollision(pipes, groundY) {
                // الاصطدام بالأرض
                if (this.y + this.radius >= groundY) {
                    return true;
                }
                
                // الاصطدام بالأنابيب
                for (let pipe of pipes) {
                    // الأنابيب العلوية
                    if (this.x + this.radius > pipe.x && 
                        this.x - this.radius < pipe.x + pipe.width && 
                        this.y - this.radius < pipe.topHeight) {
                        return true;
                    }
                    
                    // الأنابيب السفلية
                    if (this.x + this.radius > pipe.x && 
                        this.x - this.radius < pipe.x + pipe.width && 
                        this.y + this.radius > pipe.bottomY) {
                        return true;
                    }
                }
                
                return false;
            }
        }
        
        // الأنابيب (تم تعديلها لجعلها أسهل)
        class Pipe {
            constructor() {
                this.width = 70;
                this.x = canvas.width;
                this.gap = 200; // زيادة الفجوة بين الأنابيب لجعل اللعبة أسهل
                this.topHeight = 80 + Math.random() * (canvas.height - 300); // جعل الأنابيب أقصر
                this.bottomY = this.topHeight + this.gap;
                this.speed = 2.5; // تقليل سرعة الأنابيب
                this.passed = false;
                this.color = GREEN;
                this.highlight = '#427D37'; // لون التظليل
            }
            
            draw() {
                // الأنبوب العلوي
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, 0, this.width, this.topHeight);
                
                ctx.fillStyle = this.highlight;
                ctx.fillRect(this.x, this.topHeight - 20, this.width, 20);
                ctx.fillRect(this.x - 2, 0, 5, this.topHeight);
                
                // الأنبوب السفلي
                ctx.fillStyle = this.color;
                ctx.fillRect(this.x, this.bottomY, this.width, canvas.height - this.bottomY);
                
                ctx.fillStyle = this.highlight;
                ctx.fillRect(this.x, this.bottomY, this.width, 20);
                ctx.fillRect(this.x - 2, this.bottomY, 5, canvas.height - this.bottomY);
            }
            
            update() {
                this.x -= this.speed;
            }
            
            isOffScreen() {
                return this.x + this.width < 0;
            }
        }
        
        // السحب
        class Cloud {
            constructor() {
                this.x = canvas.width + Math.random() * 100;
                this.y = 50 + Math.random() * 150;
                this.speed = 0.5 + Math.random();
                this.size = 30 + Math.random() * 30;
            }
            
            draw() {
                ctx.fillStyle = WHITE;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.beginPath();
                ctx.arc(this.x + this.size * 0.5, this.y - this.size * 0.3, this.size * 0.7, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.beginPath();
                ctx.arc(this.x + this.size, this.y, this.size * 0.8, 0, Math.PI * 2);
                ctx.fill();
            }
            
            update() {
                this.x -= this.speed;
                if (this.x + this.size < 0) {
                    this.x = canvas.width + Math.random() * 100;
                    this.y = 50 + Math.random() * 150;
                }
            }
        }
        
        // الأرض
        class Ground {
            constructor() {
                this.y = canvas.height - 80;
                this.x = 0;
                this.speed = 2.5; // تقليل سرعة الأرض لتتناسب مع سرعة الأنابيب
                this.pattern = [];
                this.generatePattern();
            }
            
            generatePattern() {
                this.pattern = [];
                for (let i = 0; i < canvas.width + 100; i += 20) {
                    let height = 5 + Math.random() * 10;
                    this.pattern.push({x: i, height});
                }
            }
            
            draw() {
                ctx.fillStyle = BROWN;
                ctx.fillRect(0, this.y, canvas.width, canvas.height - this.y);
                
                // العشب
                ctx.fillStyle = GREEN;
                for (let item of this.pattern) {
                    ctx.fillRect(item.x - this.x % 20, this.y, 20, 5);
                    
                    // نتوءات العشب
                    for (let j = 0; j < 3; j++) {
                        let offset = Math.random() * 15;
                        ctx.beginPath();
                        ctx.moveTo(item.x - this.x % 20 + offset, this.y);
                        ctx.lineTo(item.x - this.x % 20 + offset, this.y - item.height);
                        ctx.lineWidth = 2;
                        ctx.strokeStyle = GREEN;
                        ctx.stroke();
                    }
                }
            }
            
            update() {
                this.x += this.speed;
            }
        }
        
        // الجسيمات
        class Particle {
            constructor(x, y, color) {
                this.x = x;
                this.y = y;
                this.color = color;
                this.size = 2 + Math.random() * 3;
                this.speedX = -2 + Math.random() * 4;
                this.speedY = -2 + Math.random() * 4;
                this.life = 20 + Math.random() * 20;
            }
            
            draw() {
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.fill();
            }
            
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                this.life -= 1;
                this.size = Math.max(0, this.size - 0.1);
                return this.life <= 0;
            }
        }
        
        // إنشاء كائنات اللعبة
        let bird = new Bird();
        let pipes = [];
        let clouds = Array.from({length: 5}, () => new Cloud());
        let ground = new Ground();
        let particles = [];
        
        // الأصوات
        function playJumpSound() {
            // توليد صوت القفز
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 400;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.1);
        }
        
        function playScoreSound() {
            // توليد صوت النقاط
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 800;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.15);
        }
        
        function playHitSound() {
            // توليد صوت الاصطدام
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 200;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.3);
        }
        
        function playDieSound() {
            // توليد صوت الموت
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.value = 150;
            oscillator.type = 'sine';
            
            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
            
            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.5);
        }
        
        // إعادة تعيين اللعبة
        function resetGame() {
            bird = new Bird();
            pipes = [];
            particles = [];
            score = 0;
            pipeTimer = 0;
            gameState = "start";
            startScreen.classList.remove('hidden');
            gameOverScreen.classList.add('hidden');
        }
        
        // التحكم في الأحداث
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                if (gameState === "start") {
                    gameState = "playing";
                    startScreen.classList.add('hidden');
                } else if (gameState === "playing") {
                    bird.jump();
                } else if (gameState === "game_over") {
                    resetGame();
                }
            }
        });
        
        canvas.addEventListener('click', () => {
            if (gameState === "start") {
                gameState = "playing";
                startScreen.classList.add('hidden');
            } else if (gameState === "playing") {
                bird.jump();
            } else if (gameState === "game_over") {
                resetGame();
            }
        });
        
        // دورة اللعبة الرئيسية
        function gameLoop() {
            // تحديث حالة اللعبة
            scrollOffset += 0.5;
            
            // تحديث السحب
            for (let cloud of clouds) {
                cloud.update();
            }
            
            // تحديث الأرض
            ground.update();
            
            // تحديث الجسيمات
            particles = particles.filter(p => !p.update());
            
            if (gameState === "playing") {
                // تحديث الطائر
                bird.update();
                
                // إنشاء أنابيب جديدة (بمعدل أبطأ)
                pipeTimer += 1;
                if (pipeTimer > 120) { // كل 120 إطار (حوالي 2 ثانية) بدلاً من 90
                    pipes.push(new Pipe());
                    pipeTimer = 0;
                }
                
                // تحديث الأنابيب
                for (let pipe of pipes) {
                    pipe.update();
                    
                    // حساب النقاط
                    if (!pipe.passed && pipe.x + pipe.width < bird.x) {
                        pipe.passed = true;
                        score += 1;
                        playScoreSound();
                        
                        // إضافة جسيمات عند تسجيل النقاط
                        for (let i = 0; i < 10; i++) {
                            particles.push(new Particle(
                                pipe.x + pipe.width / 2,
                                pipe.topHeight + pipe.gap / 2,
                                YELLOW
                            ));
                        }
                    }
                }
                
                // إزالة الأنابيب التي خرجت من الشاشة
                pipes = pipes.filter(pipe => !pipe.isOffScreen());
                
                // التحقق من الاصطدام
                if (bird.checkCollision(pipes, ground.y)) {
                    playHitSound();
                    playDieSound();
                    gameState = "game_over";
                    highScore = Math.max(highScore, score);
                    
                    // إضافة جسيمات عند الاصطدام
                    for (let i = 0; i < 20; i++) {
                        particles.push(new Particle(
                            bird.x,
                            bird.y,
                            RED
                        ));
                    }
                    
                    // عرض شاشة نهاية اللعبة
                    finalScoreElement.textContent = `النقاط: ${score}`;
                    gameOverScreen.classList.remove('hidden');
                }
            }
            
            // الرسم
            // الخلفية
            ctx.fillStyle = SKY_BLUE;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // عناصر الخلفية البعيدة
            ctx.fillStyle = '#C8E6FF';
            for (let elem of backgroundElements) {
                let newX = (elem.x - scrollOffset * 0.2) % (canvas.width + 50) - 25;
                ctx.beginPath();
                ctx.arc(newX, elem.y, elem.size, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // السحب
            for (let cloud of clouds) {
                cloud.draw();
            }
            
            // الأنابيب
            for (let pipe of pipes) {
                pipe.draw();
            }
            
            // الأرض
            ground.draw();
            
            // الطائر
            if (gameState !== "game_over" || Date.now() % 1000 < 500) {
                bird.draw();
            }
            
            // الجسيمات
            for (let particle of particles) {
                particle.draw();
            }
            
            // النقاط
            ctx.font = "36px Arial";
            ctx.fillStyle = WHITE;
            ctx.textAlign = "left";
            ctx.fillText(`النقاط: ${score}`, 10, 40);
            
            ctx.textAlign = "right";
            ctx.fillText(`أفضل نتيجة: ${highScore}`, canvas.width - 10, 40);
            
            // الاستمرار في دورة اللعبة
            requestAnimationFrame(gameLoop);
        }
        
        // بدء اللعبة
        gameLoop();
    </script>
</body>
</html>